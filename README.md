# Самодельный датчик температуры и сбор данных с него

За основу была взята [статья на муське](https://mysku.club/blog/ebay/71006.html).
Если она выжила к моменту, когда вы это читаете, то можете обратиться напрямую к ней.
Если нет, то скажу самое главное здесь:

### 1. Первый компонент - адаптер USB-UART
![Выглядит адаптер так](/img/s-l1600.jpg)

*Важно:* нужно покупать на чипе CP2102! В моём случае была куплена горсть таких свистков [на ebay](https://www.ebay.com/itm/152895017873). Все оказались исправны и с течением времени пошли в дело.

### 2. Второй компонент - термодатчик DS18B20
![Термодатчик](/img/ds18b20-waterproof.jpg)

Купить можно повсеместно, например, [тут](https://clck.ru/34afcr).

### 3. Собрать-спаять воедино
![Распайка адаптера](/img/cc9b80.jpg)

Степень замороченности исполнения у всех своя, можно оформить всё в красивый корпус из под флешки, или затолкать плату в термоусадку, или оставить всё as is - тут исключительно простор для вашей фантазии и челлендж для прямизны рук.

### 4. Настройка ПО для Debian/Ubuntu
<pre>
Обновление, установка, настройка

# sudo usermod -a  -G tty www-data
# sudo usermod -a  -G dialout www-data
# apt-get update
# apt-get upgrade
# apt-get install digitemp
# ls -l /dev/ttyUSB*
crw-rw---- 1 root dialout 188, 0 Aug  1 08:13 /dev/ttyUSB0

# digitemp_DS9097 -w -s /dev/ttyUSB0
DigiTemp v3.7.1 Copyright 1996-2015 by Brian C. Lane
GNU General Public License v2.0 - http://www.digitemp.com
Turning off all DS2409 Couplers
.
Devices on the Main LAN
28FF5C5D71160584 : DS18B20 Temperature Sensor

# digitemp_DS9097 -i -s /dev/ttyUSB0
# cp .digitemprc /etc/digitemp.conf

# digitemp_DS9097 -t 0 -q -o "%.1C" -c /etc/digitemp.conf
29.1
 </pre>
 
 ### 5. Предназначение файлов в репозитории
 - *digitemp.conf*. Файл с примером конфигурации, положите его в /etc.
 - *temperature.sh*. Исполняемый файл, располагайте в любом удобном месте. При выполнении отдаёт значение температуры, которое можно использовать далее в любых системах мониторинга. У меня Zabbix.
 - *zabbix-agentd.conf*. Если у вас тоже Zabbix, то в конфиг его агента надо добавить одну строчку, которая указана в этом файле. Не заменяйте свой конфиг целиком на этот, добавьте только эту строку! Потом уже средствами заббикса можно ловить выдаваемую цифру и строить всякие графики и т.п., но это уже совсем другая история.

Собранные мной вот такие девайсы успешно работают годами, может, и вам сгодятся. Спасибо за внимание.
